---
title: 'A02: Professor Diamond Data Regression Models'
author: "Cadence Fisher"
date: '2022-03-26'
slug: a02-professor-diamond-data-regression-models
categories: []
tags: []
---
```{r}
library(readr)
library(readxl)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(psych)
```

```{r}
diamonds <- read_excel("/Users/cfish/Downloads/Professor_Proposes_Data.xlsx")
glimpse(diamonds)
```
```{r}
attach(diamonds)
```


```{r}
colnames(diamonds)
```
# Initial analysis of Data
## Price
From the graph below, we can gauge that carat has a bimodal distribution, split at around 0.5 carats
```{r}
ggplot(diamonds, aes(Carat)) +
  geom_bar()
```
```{r}
describe(diamonds$Carat)
```

## Colour
Colour has a unimodal, nearly symmetric distribution
```{r}
ggplot(diamonds, aes(Colour)) +
  geom_bar()
```
```{r}
diamonds %>%
  count(Colour)
```


## Clarity
clarity has a unimodal distribution that is skewed a little to the left
```{r}
ggplot(diamonds, aes(Clarity)) +
  geom_bar()
```
```{r}
diamonds %>%
  count(Clarity)
```
## Cut
Cut has a unimodal distribution skewed to the right
```{r}
ggplot(diamonds, aes(Cut)) +
  geom_bar()
```
```{r}
diamonds %>%
  count(Cut)
```
## Certification
Certification has a unimodal distribution that is skewed to the right
```{r}
ggplot(diamonds, aes(Certification)) +
  geom_bar()
```
```{r}
diamonds %>%
  count(Certification)
```
## Polish
polish has a bimodal distribution, split between F, G, and I; and v, V, and X
```{r}
ggplot(diamonds, aes(Polish)) +
  geom_bar()
```
```{r}
diamonds %>%
  count(Polish)
```
## Symmetry
symmetry has a bimodal distribution, with a low count of I splitting the bump of F and G with the bump of V and X
```{r}
ggplot(diamonds, aes(Symmetry)) +
  geom_bar()
```
```{r}
diamonds %>%
  count(Symmetry)
```
## Price
Price has a bimodal distribution that is split at around $1,500. 
```{r}
ggplot(diamonds, aes(Price)) +
  geom_bar()
```
```{r}
describe(diamonds$Price)
```
# Converting the Data to Metric
```{r, warning=FALSE}
library(caret)
```

```{r}
dummy1 <- dummyVars("~ .", data = diamonds)
diamonds_mod <- data.frame((predict(dummy1, newdata = diamonds)))
glimpse(diamonds_mod)
```
## Removing Low Price Data
Because the Professor's diamond ended up being $3,000, we can conclude that he is not really interested in looking at diamonds in the lower hump of price's bimodal distribution
```{r}
diamonds_high <- diamonds_mod %>%
  filter(diamonds_mod$Price > 1500)
head(diamonds_high)
```
```{r}
diamonds_high_nothot <- diamonds %>%
  filter(diamonds$Price > 1500)

```

# Graphing the Data
## Carat

```{r}
ggplot(diamonds_high,aes(Carat, Price)) +
  geom_point(aes(color = Carat)) +
  geom_smooth(method='lm', se=FALSE, color='turquoise4') +
  theme_minimal() +
  labs(x='Carat', y='Price', title='Plot of Carat v.s. Price') +
  theme(plot.title = element_text(hjust=0.5, size=20, face='bold')) 
```
```{r}
lmcarat <- lm(Price ~ Carat, data = diamonds_high)
summary(lmcarat)

```
```{r}
anovacarat <- aov(Price ~ Carat, data = diamonds_high_nothot)
summary(anovacarat)
```

The adjusted R-squared value of 0.1034 indicates that there is somewhat of a correlation between carat and price. Interestingly, for these higher priced diamonds, the higher carat diamonds are predicted to actually have a lower price
## Color
```{r}
lmcolor <- lm(Price ~ ColourD + ColourE + ColourF + ColourG + ColourH + ColourI + ColourJ, data = diamonds_high)
summary(lmcolor)
anovacolor <- aov(Price ~ Colour, data = diamonds_high_nothot)
summary(anovacolor)

```



```{r}
ggplot(diamonds_high_nothot, aes(Colour, Price)) +
  geom_col(aes(fill = Colour)) +
  theme_minimal() +
  labs(x='Colour', y='Price', title='Plot of Colour v.s. Price') +
  theme(plot.title = element_text(hjust=0.5, size=20, face='bold')) 
```

## Clarity
```{r}
lmclarity <- lm(Price ~Clarity, data = diamonds_high_nothot)
summary(lmclarity)
anovaclarity <- aov(Price ~ Clarity, data = diamonds_high_nothot)
summary(anovaclarity)
```
With an adjusted R-squared of 0.3881,Clarity does not seem like a great predictor of Price 

```{r}
ggplot(diamonds_high_nothot, aes(Clarity, Price)) +
  geom_col(aes(fill = Clarity)) +
  geom_smooth(method='lm', se=FALSE, color='red') +
  theme_minimal() +
  labs(x='Clarity', y='Price', title='Plot of Clarity v.s. Price') +
  theme(plot.title = element_text(hjust=0.5, size=20, face='bold')) 
```
# Break: quesitons to ask
is there a reason to upload to github and turn the data into a csv i feel like reading it from an excel works fine and i do not see a difference
how are you changing your non metric data to metric? i cannot find a way to code it to do so, and thus I am unable to graph them as dotplots
are you wanting us to do multivartiate analysis? it seemed like you did not care about that in class but I am not sure
# Cut
```{r}
lm(Price ~ Cut, data = diamonds_mod)
```
```{r}
ggplot(diamonds_mod,aes(Cut, Price)) +
  geom_point(aes(color = Cut)) +
  geom_smooth(method='lm', se=FALSE, color='turquoise4') +
  theme_minimal() +
  labs(x='Cut', y='Price', title='Plot of Cut v.s. Price') +
  theme(plot.title = element_text(hjust=0.5, size=20, face='bold')) 
```
# Certification
```{r}
lm(Price ~ Certification, data = diamonds_mod)
```

```{r}
ggplot(diamonds_mod,aes(Certification, Price)) +
  geom_point(aes(color = Certification)) +
  geom_smooth(method='lm', se=FALSE, color='blue') +
  theme_minimal() +
  labs(x='Clarity', y='Price', title='Plot of Certification v.s. Price') +
  theme(plot.title = element_text(hjust=0.5, size=20, face='bold')) 
```
# Polish
```{r}
lm(Price ~ Polish, data = diamonds_mod)
```

```{r}
ggplot(diamonds_mod,aes(Polish, Price)) +
  geom_point(aes(color = Polish)) +
  geom_smooth(method='lm', se=FALSE, color='green') +
  theme_minimal() +
  labs(x='Polish', y='Price', title='Plot of Polish v.s. Price') +
  theme(plot.title = element_text(hjust=0.5, size=20, face='bold')) 
```
# Symmetry
```{r}
lm(Price ~ Symmetry, data = diamonds_mod)
```

```{r}
ggplot(diamonds_mod,aes(Symmetry, Price)) +
  geom_point(aes(color = Symmetry)) +
  geom_smooth(method='lm', se=FALSE, color='turquoise4') +
  theme_minimal() +
  labs(x='Symmetry', y='Price', title='Plot of Symmetry v.s. Price') +
  theme(plot.title = element_text(hjust=0.5, size=20, face='bold')) 
```



